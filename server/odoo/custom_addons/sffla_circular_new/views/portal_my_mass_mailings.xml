<odoo>
<template id="portal_my_mass_mailings" name="My Mass Mailings">
    <t t-call="portal.portal_layout">
        <t t-set="title" t-value="'My Mass Mailings'"/>

        <div class="container mt-3">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="mb-0">Circular</h3>
                <!--div>
                    <a href="/portal/my_mass_mailings/new" class="btn btn-primary">
                        <i class="fa fa-plus me-2"/>Create New
                    </a>
                </div-->
            </div>

            <div class="card mb-3">
                <div class="card-body py-2">
                    <form method="get" action="/portal/my_mass_mailings">
                        <div class="row">
                            <!-- Status Filter -->
                            <!--div class="col-md-4">
                                <select class="form-select" name="status" onchange="this.form.submit()">
                                    <option value="all" t-att-selected="current_status == 'all'">All Statuses</option>
                                    <option value="draft" t-att-selected="current_status == 'draft'">Draft</option>
                                    <option value="in_queue" t-att-selected="current_status == 'in_queue'">In Queue</option>
                                    <option value="sending" t-att-selected="current_status == 'sending'">Sending</option>
                                    <option value="done" t-att-selected="current_status == 'done'">Sent</option>
                                </select>
                            </div-->

                            <!--Type Filter>
                            <div class="col-md-4">
                                <select class="form-select" name="msg_type" onchange="this.form.submit()">
                                    <option value="all" t-att-selected="current_type == 'all'">All Types</option>
                                    <option value="email" t-att-selected="current_type == 'email'">Email</option>
                                    <option value="sms" t-att-selected="current_type == 'sms'">SMS</option>
                                </select>
                            </div-->

                            <!-- Search -->
                            <div class="col-md-4">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="search" placeholder="Search..." t-att-value="search"/>
                                    <button class="btn btn-outline-secondary" type="submit">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div t-if="not mailings" class="alert alert-info mt-4">
                <i class="fa fa-info-circle me-2"/>No mass mailings found matching your criteria.
            </div>

            <div t-if="mailings" class="card mb-4">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Subject</th>
                            <th>Type</th>
                            <th>Schedule Date</th>
                            <th>Recipients</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="mailings" t-as="mailing">
                            <tr>
                                <td>
                                    <a t-attf-href="/portal/mass_mailing_detail/#{mailing.id}">
                                        <i class="fa fa-envelope me-2"/>
                                        <t t-out="mailing.subject or 'Untitled'"/>
                                    </a>
                                    <t t-if="mailing.ab_testing_enabled">
                                        <span class="badge bg-info ms-2">A/B Test</span>
                                    </t>
                                </td>
                                <td>
                                    <span t-out="mailing.mailing_type_description"/>
                                </td>
                                <td>
                                    <span t-out="mailing.calendar_date"/>
                                </td>
                                <td>
                                    <dd class="col-sm-8">
                                        <t t-foreach="mailing.contact_list_ids" t-as="mlist">
                                            <span t-esc="mlist.name"/><br/>
                                        </t>
                                    </dd>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </div>

        </t>
</template>
<template id="portal_mass_mailing_detail" name="Mass Mailing Detail">
    <t t-call="portal.portal_layout">
        <t t-set="title" t-value="'Mass Mailing Details'"/>

        <div class="container mt-3">
            <!-- Back button and header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <a href="/portal/my_mass_mailings" class="btn btn-outline-secondary">
                    <i class="fa fa-arrow-left me-2"></i>Back to List
                </a>
                <h3 class="mb-0">Circular Details</h3>
                <!--div>
                    <t t-if="mailing.state != 'done'">
                        <a t-attf-href="/my/mass_mailings/#{mailing.id}/edit"
                           class="btn btn-warning me-2">
                            <i class="fa fa-edit me-1"></i>Edit
                        </a>
                        <a t-attf-href="/my/mass_mailings/#{mailing.id}/send_test"
                           class="btn btn-info me-2">
                            <i class="fa fa-paper-plane me-1"></i>Send Test
                        </a>
                    </t>
                    <a t-attf-href="/my/mass_mailings/#{mailing.id}/stats"
                       class="btn btn-primary">
                        <i class="fa fa-bar-chart me-1"></i>Full Statistics
                    </a>
                </div-->
            </div>

            <!-- Summary card -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <i class="fa fa-info-circle me-2"></i>Information
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <dl class="row mb-0">
                                <dt class="col-sm-4">Subject:</dt>
                                <dd class="col-sm-8" t-out="mailing.subject or 'Untitled'"/>

                                <dt class="col-sm-4">Type:</dt>
                                <dd class="col-sm-8" t-out="mailing.mailing_type_description"/>

                                <dt class="col-sm-4">Status:</dt>
                                <dd class="col-sm-8">
                                    <span t-attf-class="badge bg-#{'success' if mailing.state == 'done' else 'warning'}">
                                        <t t-out="mailing.state.upper()"/>
                                    </span>
                                    <t t-if="mailing.ab_testing_enabled">
                                        <span class="badge bg-info ms-2">A/B TESTING</span>
                                    </t>
                                </dd>

                                <!--dt class="col-sm-4">Schedule Date:</dt>
                                <dd class="col-sm-8">
                                    <t t-if="mailing.calendar_date">
                                        <span t-out="mailing.calendar_date"/>
                                        <small class="text-muted ms-2">
                                            <t t-out="mailing.calendar_date.strftime('%I:%M %p')"/>
                                        </small>
                                    </t>
                                    <t t-else="">Not scheduled</t>
                                </dd-->
                            </dl>
                        </div>
                        <div class="col-md-6">
                            <dl class="row mb-0">
                                <dt class="col-sm-4">Recipients:</dt>
                                <!--dd class="col-sm-8" t-out="mailing.mailing_domain"/-->
                                <dd class="col-sm-8">
                                    <t t-foreach="mailing.contact_list_ids" t-as="mlist">
                                        <span t-esc="mlist.name"/><br/>
                                    </t>
                                </dd>



                                <dt class="col-sm-4">Sent Date:</dt>
                                <dd class="col-sm-8">
                                    <t t-if="mailing.calendar_date">
                                        <span t-out="mailing.calendar_date"/>
                                        <!--small class="text-muted ms-2">
                                            <t t-out="mailing.calendar_date.strftime('%I:%M %p')"/>
                                        </small-->
                                    </t>
                                    <t t-else="">Not sent yet</t>
                                </dd>

                                <dt class="col-sm-4">Campaign:</dt>
                                <dd class="col-sm-8" t-out="mailing.campaign_id.display_name or 'None'"/>

                                <dt class="col-sm-4">Source:</dt>
                                <!--dd class="col-sm-8" t-out="mailing.source_id.display_name or 'None'"/-->
                                <dd class="col-sm-8" t-out="mailing.display_name or 'None'"/>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance stats -->
            <!--div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-white bg-success h-100">
                        <div class="card-body text-center">
                            <h5 class="card-title" t-out="mailing.delivered or 0"/>
                            <p class="card-text">Delivered</p>
                            <t t-if="mailing.state == 'done'">
                                <small class="opacity-75">
                                    <t t-out="'%.1f%%' % (mailing.received_ratio * 100)"/>
                                </small>
                            </t>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-white bg-info h-100">
                        <div class="card-body text-center">
                            <h5 class="card-title" t-out="mailing.opened or 0"/>
                            <p class="card-text">Opened</p>
                            <t t-if="mailing.state == 'done'">
                                <small class="opacity-75">
                                    <t t-out="'%.1f%%' % (mailing.opened_ratio * 100)"/>
                                </small>
                            </t>
                        </div>
                    </div>
                </div-->
                <!--div class="col-md-3">
                    <div class="card text-white bg-primary h-100">
                        <div class="card-body text-center">
                            <h5 class="card-title" t-out="mailing.replied or 0"/>
                            <p class="card-text">Replied</p>
                            <t t-if="mailing.state == 'done'">
                                <small class="opacity-75">
                                    <t t-out="'%.1f%%' % (mailing.replied_ratio * 100)"/>
                                </small>
                            </t>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-white bg-danger h-100">
                        <div class="card-body text-center">
                            <h5 class="card-title" t-out="mailing.bounced or 0"/>
                            <p class="card-text">Bounced</p>
                            <t t-if="mailing.state == 'done'">
                                <small class="opacity-75">
                                    <t t-out="'%.1f%%' % (mailing.bounced_ratio * 100)"/>
                                </small>
                            </t>
                        </div>
                    </div>
                </div>
            </div-->

            <!-- Content tabs -->
            <ul class="nav nav-tabs" id="mailingTabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="content-tab" data-bs-toggle="tab" href="#content" role="tab">
                        <i class="fa fa-file-text me-1"></i>Content
                    </a>
                </li>
                <!--li class="nav-item">
                    <a class="nav-link" id="stats-tab" data-bs-toggle="tab" href="#stats" role="tab">
                        <i class="fa fa-bar-chart me-1"></i>Statistics
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="settings-tab" data-bs-toggle="tab" href="#settings" role="tab">
                        <i class="fa fa-cog me-1"></i>Settings
                    </a>
                </li-->
                <t t-if="mailing.ab_testing_enabled">
                    <li class="nav-item">
                        <a class="nav-link" id="abtest-tab" data-bs-toggle="tab" href="#abtest" role="tab">
                            <i class="fa fa-flask me-1"></i>A/B Testing
                        </a>
                    </li>
                </t>
            </ul>

            <div class="tab-content border-start border-end border-bottom p-3" id="mailingTabsContent">
                <!-- Content tab -->
                <div class="tab-pane fade show active" id="content" role="tabpanel">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 t-out="mailing.subject or 'Untitled'"/>
                        <div>
                            <span class="badge bg-secondary me-2">
                                From: <t t-out="mailing.email_from"/>
                            </span>
                            <t t-if="mailing.reply_to">
                                <span class="badge bg-secondary">
                                    Reply-To: <t t-out="mailing.reply_to"/>
                                </span>
                            </t>
                        </div>
                    </div>

                    <div class="border p-3 bg-light" t-field="mailing.body_arch" t-options="{'widget': 'html'}"/>

                    <t t-if="mailing.attachment_ids">
                        <h5 class="mt-4">Attachments</h5>
                        <ul class="list-group">
                            <t t-foreach="mailing.attachment_ids" t-as="attachment">
                                <li class="list-group-item">
                                    <i class="fa fa-paperclip me-2"/>
                                    <a t-att-href="'/web/content/%s/%s' % (attachment.id, attachment.name)"
                                       t-out="attachment.name" download=""/>
                                    <small class="text-muted ms-2" t-out="'%.2f MB' % (attachment.file_size / (1024 * 1024))"/>
                                </li>
                            </t>
                        </ul>
                    </t>
                </div>

                <!-- Statistics tab -->
                <div class="tab-pane fade" id="stats" role="tabpanel">
                    <div class="alert alert-info">
                        <i class="fa fa-info-circle me-2"></i>
                        Detailed statistics will be available after the mailing is sent.
                    </div>
                </div>

                <!-- Settings tab -->
                <div class="tab-pane fade" id="settings" role="tabpanel">
                    <dl class="row">
                        <dt class="col-sm-3">Mailing Model:</dt>
                        <dd class="col-sm-9" t-out="mailing.mailing_model_name"/>

                        <dt class="col-sm-3">Mailing Domain:</dt>
                        <dd class="col-sm-9">
                            <code t-out="mailing.mailing_domain or 'All records'"/>
                        </dd>

                        <dt class="col-sm-3">Language:</dt>
                        <dd class="col-sm-9" t-out="mailing.lang or 'Default'"/>

                        <dt class="col-sm-3">Keep Archives:</dt>
                        <dd class="col-sm-9">
                            <t t-if="mailing.keep_archives">Yes</t>
                            <t t-else="">No</t>
                        </dd>

                        <dt class="col-sm-3">Mail Server:</dt>
                        <dd class="col-sm-9" t-out="mailing.mail_server_id.display_name or 'Default'"/>
                    </dl>
                </div>

                <!-- A/B Testing tab -->
                <t t-if="mailing.ab_testing_enabled">
                    <div class="tab-pane fade" id="abtest" role="tabpanel">
                        <div t-field="mailing.ab_testing_description" t-options="{'widget': 'html'}"/>

                        <div class="alert alert-info mt-3">
                            <i class="fa fa-info-circle me-2"></i>
                            This mailing is part of an A/B test with
                            <t t-out="mailing.ab_testing_mailings_count"/> variants.
                            <t t-if="mailing.ab_testing_is_winner_mailing">
                                <br/><strong>This is the winning variant.</strong>
                            </t>
                        </div>
                    </div>
                </t>
            </div>
        </div>
    </t>
</template>
</odoo>